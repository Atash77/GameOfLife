pipeline {
    agent any
    tools {
        maven 'Maven 3.6.3'
        jdk 'Java 8'
    }
    stages {
	stage('Build') {
            steps {
                sh 'mvn clean package' 
            }
	}
	stage('Deploy') {
     		steps{
		echo 'Deploying...'
		nexusArtifactUploader artifacts: [[artifactId: 'gameoflife', classifier: '', file: 'gameoflife-web/target/gameoflife.war', type: 'war']], credentialsId: 'nexus-credentials', groupId: 'com.wakaleo.gameoflife', nexusUrl: 'localhost:8081/repository/maven-releases/', nexusVersion: 'nexus2', protocol: 'http', repository: 'maven-releases', version: '1.0.8'



}
}
}
            post {
                success {
                    junit '**/target/surefire-reports/*.xml' 
                }
		{
		    sh jmeter.sh -Jjmeter.save.saveservice.output_format=xml -n -t /home/carmel/gameOfLife/game-of-life/gameoflife-web/src/test/jmeter/GameoflifeJM.jmx -l /home/carmel/gameOfLife/game-of-life/gameoflife-web/src/test/jmeter/GameoflifeJM.jtl
		}
            }
        
    }
