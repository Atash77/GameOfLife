<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
         符号转义说明
    &lt;          < 	
    &gt;          >  
    &lt;&gt;     <>
    &amp;        & 
    &apos;       '
    &quot;       "
  <![CDATA[ 这里写你的SQL或者符号 ]]> 
 -->
<mapper namespace="com.huilian.hlej.hcf.dao.ActivityTemplateDao" > 

	<select id="getActivityTemplateList" resultType="com.huilian.hlej.hcf.vo.ActivityConterTemplateVo" parameterType="com.huilian.hlej.hcf.vo.ActivityConterTemplateVo">
       SELECT  DISTINCT   ss.id, ss.schemeNo,ss.schemeName,ss.createTime ,ss.template_name ,ss.template_id  FROM   
       hcf_activity_template ss , 
       hcf_activity_templat dd
        <where>
        	ss.template_id=dd.template_id  
            
            <if test="templateName != null and  templateName != ''">
            AND ss.template_name  like  CONCAT('%','${templateName}','%' )
            </if>
            
        </where>
       		    ORDER BY  ss.createTime desc
    	</select>
    	
   
		
    	<select id="getTemplateByid" resultType="com.huilian.hlej.hcf.vo.ActivityManageVo" >
	       SELECT
				*
			FROM
			  hsh_activity_scheme
	        <where>
	        	templateId   =  #{0}
	        </where>
    	</select>
    	<select id="seleByschemeNo" resultType="com.huilian.hlej.hcf.vo.ActivityManageVo" >
	       SELECT
				*
			FROM
			  hsh_activity_scheme
	        <where>
	        	schemeNo   =  #{schemeNo}
	        </where>
    	</select>
    	
    	
    
    	
    	<select id="getTemplateName" resultType="com.huilian.hlej.hcf.vo.AnctivityTempleVo" >
	       SELECT
				*
			FROM
			  hcf_activity_templat
	        <where>
	        	template_id   =  #{0}
	        </where>
    	</select>
    	
    	<select id="getTemplateByName" resultType="com.huilian.hlej.hcf.vo.AnctivityTempleVo" >
	       SELECT
				*
			FROM
			  hcf_activity_templat
	        <where>
	        	template_name   =  #{0}
	        </where>
    	</select>
    	
    	<select id="getActivityManageByTemplateName" resultType="com.huilian.hlej.hcf.vo.ActivityConterTemplateVo" >
	       SELECT
				*
			FROM
			  hcf_activity_template 
	        <where>
	        	template_id   =  #{0}
	        </where>
    	</select>
    	
    	
    	
    	<select id="getActivityManageByTemplateNames" resultType="com.huilian.hlej.hcf.vo.ActivityConterTemplateVo" >
	            UPDATE `hcf_activity_template`
			<set>
		
			<if test="vendCode!=null and vendCode!=''">
				vendCode = #{vendCode},
			</if>
				createTime = now()
			</set>
	         WHERE	template_id   =  #{0}  and   schemeNo = #{0}
	        
    	</select>
    	
    	
    
		<!-- 查询,主键查询   -->
	<select id="getActivityTemplateByCode"  resultType="com.huilian.hlej.hcf.vo.ActivityManageVo"  >
		SELECT
			vm.*
		FROM
			hsh_activity_scheme vm    where 1=1  and template_id=#{0}
	</select>
	
	
	
		<!-- 查询,主键查询   -->
	<select id="selectByTemplateId"  resultType="com.huilian.hlej.hcf.vo.VendingMachineVo"  >
		SELECT
			vm.*
		FROM
			hsh_vend_qr_code vm    where 1=1  and vendCode=#{0}
	</select>
	
	
	
	
		<!-- 查询,主键查询   -->
	<select id="selectVendByTemplateId"  resultType="com.huilian.hlej.hcf.vo.VendingMachineVo"  >
		SELECT
			vm.*
		FROM
			hsh_vend_qr_code vm    where 1=1  and template_id=#{0}
	</select>
	
	
    
		<!-- 查询,主键查询   -->
	<select id="getTemplateByTemplateName"  resultType="com.huilian.hlej.hcf.vo.AnctivityTempleVo"  >
		SELECT
			vm.*
		FROM
			hcf_activity_templat vm    where 1=1  and template_id=#{0}
	</select>
	
	<update id="updateBySchemno" >
	       UPDATE `hcf_activity_template`
			<set>
			
			<if test="schemeNo!=null and schemeNo!=''">
				schemeNo = #{schemeNo},
			</if>
			<if test="schemeName!=null and schemeName!=''">
				schemeName = #{schemeName},
			</if>
				
				createTime = now()
			</set>
			WHERE schemeNo = #{schemeNo}	
	       
	    </update>
	    
	
	<update id="updateActivityConterManage" >
	       UPDATE `hcf_activity_template`
			<set>
			<if test="vendCode!=null and vendCode!=''">
				vendCode = #{vendCode},
			</if>
				
				createTime = now()
			</set>
			WHERE template_id = #{0}	
	       
	    </update>
	    
	    
	    
	    
	<update id="updateVendingByCode" >
	       UPDATE `hsh_vend_qr_code`
			<set>
				
			
					template_id = #{templateId},
					oldTemplate_id = #{oldTemplateId},
					fabuRecort = #{fabuRecort},
					oldTemplate_id = #{oldTemplateId},
				
				
				updateTime = now()
			</set>
			WHERE vendCode = #{vendCode}	
	       
	    </update>
	    
	    
	    
	<update id="updateActivityManageBySchemno" >
	       UPDATE `hsh_activity_scheme`
			<set>
				
			
					template_id = #{templateId},
				
				
				updateTime = now()
			</set>
			WHERE schemeNo = #{schemeNo}	
	       
	    </update>
	    
	    
    	
	<update id="updateByTemplate" >
	       UPDATE `hcf_activity_templat`
			<set>
				
			<if test="templateId!=null and templateId!=''">
				template_id = #{templateId},
			</if>
			<if test="templateName!=null and templateName!=''">
				template_name = #{templateName},
			</if>
			<if test="remark!=null and remark!=''">
				remark = #{remark},
			</if>
				createTime = now()
			</set>
			WHERE id = #{id}	
	       
	    </update>
    	
    	
    	
   <insert id="saveTemPlate" useGeneratedKeys="true" keyProperty="id">
  	 INSERT INTO `hcf_activity_templat`(
	 		  `template_id` ,
	 		   `remark`,
			  `template_name`,
			  
			  `createTime`
		)
		VALUES
			(
				#{templateId},
				#{remark},
				#{templateName},
				
				now()
			);
 </insert>
 
 
  <insert id="saveActivityConterTemplate" useGeneratedKeys="true" keyProperty="id">
  	 INSERT INTO `hcf_activity_template`(
	 		  `template_id` ,
	 		  `schemeNo` ,
	 		  `schemeName` ,
			  `template_name`,
			
			  `createTime`
		)
		VALUES
			(
				#{templateId},
				#{schemeNo},
				#{schemeName},
				#{templateName},
			
				now()
			);
 </insert>
 
 <update id="deteTemplateByTemplateId" parameterType="com.huilian.hlej.hcf.vo.AnctivityTempleVo" >
	       DELETE  from  `hcf_activity_templat`
	       
			WHERE template_id = #{templateId}
	       
    </update>
	
</mapper>   
