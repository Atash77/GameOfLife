<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
         符号转义说明
    &lt;          < 	
    &gt;          >  
    &lt;&gt;     <>
    &amp;        & 
    &apos;       '
    &quot;       "
  <![CDATA[ 这里写你的SQL或者符号 ]]> 
 -->
<mapper namespace="com.huilian.hlej.hcf.dao.WechatMaterialModelDao" > 

	<insert id="saveWechatMaterialModelVo" useGeneratedKeys="true" keyProperty="id">
		<![CDATA[
			INSERT INTO `hcf_wechat_material_model` (
			  `model_name` ,
			  `model_no` ,
			  `wechat_no` ,
			  `create_time` ,
			  `remark` ,
			  `sort` 
			  
			)
			VALUES
				(
					#{modelName},
					#{modelNo},
					#{wechatNo},
					#{createTime},
					#{remark},
					#{sort}
				)
			]]> 
	</insert>
	
	<resultMap id="wechatMaterialModelVoMap" type="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		<result column="id" property="id" jdbcType="VARCHAR"/>
		<result column="model_name" property="modelName" jdbcType="VARCHAR"/>
		<result column="model_no" property="modelNo" jdbcType="VARCHAR"/>
		<result column="wechat_no" property="wechatNo" jdbcType="VARCHAR"/>
		<result column="create_time" property="createTime" jdbcType="VARCHAR"/>
		<result column="remark" property="remark" jdbcType="VARCHAR"/>
		<result column="sort" property="sort" jdbcType="VARCHAR"/>
		<result column="wechat_name" property="wechatName" jdbcType="VARCHAR"/>
	</resultMap>

	<select id="findWechatMaterialModelVoList" resultMap="wechatMaterialModelVoMap"
		parameterType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		SELECT
			h.id,
			h.model_name,
			h.model_no,
			h.wechat_no,
			h.create_time,
			h.remark
		FROM
			hcf_wechat_material_model AS h
		where 1=1
		<if test="modelName != null and  modelName != ''">
			AND h.model_name = #{modelName}
		</if>
		<if test="modelNo != null and  modelNo != ''">
			AND h.model_no = #{modelNo}
		</if>
		<if test="wechatNo != null and  wechatNo != ''">
			AND h.wechat_no = #{wechatNo}
		</if>
		<if test="searchText != null and  searchText != ''">
			AND (h.model_name like CONCAT('%','${searchText}','%' ) OR h.model_no like CONCAT('%','${searchText}','%' ))
		</if>
		GROUP BY model_no 
		ORDER BY  -h.sort DESC,h.create_time DESC
	</select>
	
	<select id="getWechatMaterialModelVoListNotGroup" resultMap="wechatMaterialModelVoMap"
		parameterType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		SELECT
			h.id,
			h.model_name,
			h.model_no,
			h.wechat_no,
			h.create_time,
			h.remark,
			h.sort
		FROM
			hcf_wechat_material_model AS h
		where 1=1
		<if test="modelName != null and  modelName != ''">
			AND h.model_name like CONCAT('%','${modelName}','%' )
		</if>
		<if test="modelNo != null and  modelNo != ''">
			AND h.model_no = #{modelNo}
		</if>
		<if test="wechatNo != null and  wechatNo != ''">
			AND h.wechat_no = #{wechatNo}
		</if>
		ORDER BY  -h.sort DESC,h.create_time DESC
	</select>
	
	<select id="getWechatMaterialModelVoListByModelNo" resultMap="wechatMaterialModelVoMap"
		parameterType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		SELECT
			h.id,
			h.model_name,
			h.model_no,
			h.wechat_no,
			h.create_time,
			h.remark,
			h.sort,
			o.wechat_name
		FROM
			hcf_wechat_material_model AS h LEFT OUTER JOIN
			hcf_wechat_material AS o ON h.wechat_no=o.wechat_no 
		where 1=1
		<if test="modelNo != null and  modelNo != ''">
			AND h.model_no = #{modelNo}
		</if>
		ORDER BY  -h.sort DESC, h.create_time DESC
	</select>
	
	<delete id="deleteWechatMaterialModelVo" parameterType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		<![CDATA[
			DELETE from hcf_wechat_material_model where model_no=#{modelNo}
		]]>
	</delete>
	
	
	<update id="updateWechatMaterialModelVo" parameterType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		UPDATE `hcf_wechat_material_model` 
		<set>
			<if test="modelName !=null and modelName !=''">
				model_name = #{modelName},
			</if>
			<if test="modelNo !=null and modelNo !=''">
				model_no = #{modelNo},
			</if>
			
			<if test="wechatNo !=null and wechatNo !=''">
				wechat_no = #{wechatNo},
			</if>
			<if test="createTime !=null and createTime !=''">
				create_time = #{createTime},
			</if>
			<if test="remark !=null and remark !=''">
				remark = #{remark},
			</if>
			<if test="sort !=null and sort !=''">
				sort = #{sort},
			</if>
		</set>
		<where>
				id = ${id}
		</where>
				
	</update>
	
	<select id="getWechatMaterialModelVo" parameterType="java.lang.String" resultType="com.huilian.hlej.hcf.vo.WechatMaterialModelVo">
		<![CDATA[
			SELECT *  FROM hcf_wechat_material_model AS t WHERE 1=1 AND t.id = #{id}
		]]>
	</select>
	
	<select id="checkNameOfNo" parameterType="java.lang.String" resultType="java.lang.Integer">
		<![CDATA[
			SELECT count(1) from hcf_wechat_material_model AS h where 1=1 
		]]>
		<if test="modelName != null and  modelName != ''">
			AND h.model_name = #{modelName}
		</if>
		<if test="modelNo != null and  modelNo != ''">
			AND h.model_no = #{modelNo}
		</if>
	</select>
	
	
	
	
	
	
	
	
	<resultMap id="lottoActivityVoMap" type="com.huilian.hlej.hcf.vo.LottoActivityVo">
		<result column="activityNo" property="activityNo" jdbcType="VARCHAR"/>
		<result column="activityName" property="activityName" jdbcType="VARCHAR"/>
	</resultMap>
	<select id="getLottoActivityVoAll" resultMap="lottoActivityVoMap">
		<![CDATA[
			SELECT
				activityNo,
				activityName
			FROM
				hcf_lotto_activity
		]]>	
	</select>
	
	
	<select id="getPrizeList" parameterType="com.huilian.hlej.hcf.vo.LottoVendVo" resultType="com.huilian.hlej.hcf.vo.LottoVendVo">
		<![CDATA[
			SELECT *  FROM hcf_lotto_vend_prize AS t WHERE 1=1 
		]]>
		<if test="vendCode != null and  vendCode != ''">
			AND t.vendCode = #{vendCode}
		</if>
		<if test="activityNo != null and  activityNo != ''">
			AND t.activityNo=#{activityNo}
		</if>
	</select>
	
	
	
	
	<select id="getLottoVendVoListByActivityNoAndVendCode" parameterType="com.huilian.hlej.hcf.vo.LottoVendVo" 
		resultType="com.huilian.hlej.hcf.vo.LottoVendVo">
		<![CDATA[
			SELECT *  FROM hcf_lotto_vend_prize AS t WHERE 1=1 
		]]>
		<if test="vendCode != null and  vendCode != ''">
			AND t.vendCode = #{vendCode}
		</if>
		<if test="activityNo != null and  activityNo != ''">
			AND t.activityNo=#{activityNo}
		</if>
	</select>
	
	<delete id="deleteListByActivityNoAndVendCode" parameterType="com.huilian.hlej.hcf.vo.LottoVendVo">
		<![CDATA[
			DELETE from hcf_lotto_vend_prize where activityNo=#{activityNo} AND vendCode=#{vendCode}
		]]>
	</delete>
</mapper>   
