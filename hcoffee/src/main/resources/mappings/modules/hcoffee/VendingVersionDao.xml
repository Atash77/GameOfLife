<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 
         符号转义说明
    &lt;          < 	
    &gt;          >  
    &lt;&gt;     <>
    &amp;        & 
    &apos;       '
    &quot;       "
  <![CDATA[ 这里写你的SQL或者符号 ]]> 
 -->
<mapper namespace="com.huilian.hlej.hcf.dao.AppVersionRecordsDao" > 

		<insert id="saveVendingVersion" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO `app_version_records` (
			
 		  `version` ,
		  `versionOld` ,
		   `versionOldId` ,
		  `description`,
		  `status` ,
		  `createTime` ,
		  `downloadLink`
		)
		VALUES
			(
				#{version},
				#{versionOld},
				#{versionOldId},
				#{description},
				#{status},
				now(),
				#{downloadLink}
			);
		</insert>
	


		<select id="findList" resultType="com.huilian.hlej.hcf.vo.AppVersionRecordsVo" parameterType="com.huilian.hlej.hcf.vo.AppVersionRecordsVo">
        SELECT
			vm.*
		FROM
			app_version_records vm  
			 
        <where>
        	1 = 1
            <if test="startTime != null and  startTime != ''">
                AND vm.createTime    &gt;=  #{startTime}
            </if>
    		<if test="endTime != null and  endTime != ''">
                AND vm.createTime    &lt;=  #{endTime}
            </if>
            <if test="version != null and  version != ''">
                AND vm.version like CONCAT('%','${version}','%' )
            </if>
            <if test="idList != null and  idList != ''">
                AND vm.id   in  (${idList})
            </if>
        </where>
       		    ORDER BY  vm.createTime desc
           
       
    	</select>
    	
    	<update id="updateVendingVersion">
		UPDATE `app_version_records`
		<set>
			<if test="versionOld !=null and versionOld !=''">
				versionOld = #{versionOld},
			</if>
			<if test="version !=null and version !=''">
				version = #{version},
			</if>
			<if test="versionOldId !=null and versionOldId !=''">
				versionOldId = #{versionOldId},
			</if>
 
			<if test="description !=null and description !=''">
				description = #{description},
			</if>
 
			<if test="status !=null ">
				status = #{status},
			</if>
			
			<if test="downloadLink !=null and downloadLink !=''">
				downloadLink = #{downloadLink},
			</if>
			createTime = now()
		</set>
		WHERE id = #{id}	
	</update>
	
	<delete id="deleteVendingVersion">
  		delete from app_version_records where version = #{version}
	</delete>
	
	<select id="getVendingVersionByVersion"  resultType="com.huilian.hlej.hcf.vo.AppVersionRecordsVo"  >
		SELECT
			vm.*
		FROM
			app_version_records vm    where 1=1  and version=#{0}
	</select>
</mapper>   
